<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="http://code.jquery.com/jquery-3.6.0.js"></script>
    <title>막대그래프</title>
<style>
    *{margin:0; padding:0;}
    .section{
        width:100%;
        height:1000px;
        position:relative;
    }
    #main{
        background: pink;
    }
    #about{
        background: plum;
    }
    #bar{
        position: absolute;
        left:50%; top: 50%;
        transform: translate(-50%,-50%);
        width: 50%;
    }
    .skillbar{
        width:100%;
        height:40px;
        background-color: #fff;
        margin: 5px 0;
        position: relative;
    }
    .skill_title{
        font-weight:bold;
        position: absolute;
        top:0;
        left:0;
        width: 110px;
        line-height: 40px;
        text-align:center;
        z-index:4;
    }
    .skill_percent{
        font-weight:bold;
        position: absolute;
        top:0;
        right:0;
        line-height: 40px;
        padding-right: 20px;
        text-align:center;
        z-index:4;
    }
    .skill_bar{
        width:0%;
        height:40px;
        position:absolute;
        left:0;
        top:0;
        background-color:salmon;
    }
</style>
<script> 
 $(function(){    
   $(window).scroll(function(){
        var sct = $(window).scrollTop();
        //console.log(sct);
        var off = $("#about").offset().top;
        if(sct > off){
            graph();
        }
   });
 
   function graph(){
    $('.skillbar').each(function(){
        $(this).find('.skill_bar').animate({
            "width":$(this).attr("data-percent") +"%"
        },5000);
    });    
    // 숫자 카운트 애니메이션
    // if ~ hasClass('on') = > 한 번만 실행 후 on 클래스 줘서 한 번만 실행되게끔
    if($('.skillbar').hasClass('on') == false){
        $('.Count').each(function(){
            var t = $(this);
            $({count:0}).animate({count:t.text()},{
                duration:5000,
                progress:function(){
                    t.text(Math.ceil(this.count));
                }
            });
        });

    }
   $(".skillbar").addClass("on");
   }

});
</script>
</head>
<body>
<div id="wrap">
		<div class="section" id="main">
			<h1 data-percent="99">00</h1>
		</div>
		<div class="section" id="about">
			<div id="bar">
				<div class="skillbar" data-percent="85">
					<div class="skill_title">HTML5</div>
					<div class="skill_bar"></div>
					<div class="skill_percent Count">85</div>
				</div>
				<div class="skillbar" data-percent="98">
					<div class="skill_title">CSS3</div>
					<div class="skill_bar"></div>
					<div class="skill_percent Count">98</div>
				</div>
				<div class="skillbar" data-percent="87">
					<div class="skill_title">jQuery</div>
					<div class="skill_bar"></div>
					<div class="skill_percent Count">87</div>
				</div>
				<div class="skillbar" data-percent="80">
					<div class="skill_title">Java</div>
					<div class="skill_bar"></div>
					<div class="skill_percent Count">98</div>
				</div>
				<div class="skillbar" data-percent="75">
					<div class="skill_title">Spring</div>
					<div class="skill_bar"></div>
					<div class="skill_percent Count">75</div>
				</div>
			</div>
		
		</div>
	
	</div>
</body>
</html>